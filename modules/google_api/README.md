# Google API

Python 3 module which utilizes the Google Developer APIs to send an email.

## Setup

Install the following pip dependencies:
* `argparse`
* `google-api-python-client`
* `httplib2`

Setup the [Logger](https://github.com/jleung51/scripts/tree/master/modules/logger) module in this directory.

### Authorizing Google Account Credentials

Go to the [Google Developers Console](https://console.developers.google.com/apis/api/drive/overview) and create a new project. Select your project in the top-left dropdown, and search for and enable the API for your desired Google application (Gmail, Google Drive, etc.) in the Developers Console dashboard.

From the Google Developer APIs:

* [Gmail](https://developers.google.com/gmail/api/quickstart/python)
* [Google Drive](https://developers.google.com/drive/v3/web/quickstart/python)

Follow **Step 1** to get an authentication key for the Google account to be authorized. Place `client_secret.json` in the same directory as your code.

During the first time you run the script, Google will display a URL and ask you to retrieve the verification code. Follow the instructions so you can properly authenticate your script to use your Gmail account. This will not be necessary on subsequent calls, as long as you do not modify the autogenerated file `generated_credentials.json`.

### Uploading Files to a Directory within Google Drive

In order to upload a file to a specific directory in Google Drive, the _FileId_ of the parent directory must be provided in the configuration file. If it is not provided, then the file will simply be uploaded to the root directory.

Manually create the target directory in Google Drive. Create a `GoogleDriveApi` object, execute `get_file_list()`, and and look through the results - the file IDs of all files and directories in your Google Drive. Find the file ID of the target directory and pass it to `upload_file()` as the parameter `parent_dir_id`.

## Usage

Add the `google_api.py` module and its related credential files to the directory of the Python program. Import the module in your program:
```
from google_api import GmailApi
```

Using Gmail as an example, create an object for the desired API and refresh the credentials:
```
gmail = GmailApi(source_gmail)
```

And send your email:
```
gmail.send_email(target_email, subject, message_text)
```

For detailed information on the parameters and usage, see the documentation in the class for the desired API.

## Logging

Execution details are formatted in a loggable format like so:
```
[ 2016-11-12 22:27:24 | DEBUG   ] Mail source:  me@gmail.com
[ 2016-11-12 22:27:24 | DEBUG   ] Mail target:  other_me@email.com
[ 2016-11-12 22:27:24 | DEBUG   ] Mail subject: Traffic Incident Alert
[ 2016-11-12 22:27:24 | DEBUG   ] Mail message: Serious traffic disruption. Allot extra time for returning home.
[ 2016-11-12 22:27:25 | DEBUG   ] Mail sent.
```
